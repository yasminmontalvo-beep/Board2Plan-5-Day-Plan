<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Board2Plan – 5-Day Plan (Combined)</title>
  <style>
    :root{--teal:#008080;--ink:#111;--line:#e6eaee;--soft:#f6f8f9}
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial;color:var(--ink)}
    header{background:#fff;border-bottom:1px solid var(--line)}
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--teal),#18b4b4);display:grid;place-items:center;color:#fff;font-weight:800}
    h1{font-size:22px;margin:0}
    .sub{font-size:12px;color:#666}
    .panel{border:1px solid var(--line);border-radius:14px;padding:14px;background:var(--soft)}
    .grid{display:grid;gap:12px}
    .cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}
    button{padding:10px 12px;border:1px solid var(--line);border-radius:999px;cursor:pointer;background:#3b82f6;color:#fff;font-weight:600}
    .ghost{background:#fff;color:#222}
    .pill{display:inline-block;padding:4px 10px;border:1px solid var(--line);border-radius:999px;font-size:11px;color:#555}
    .muted{color:#666;font-size:12px}
    table{width:100%;border-collapse:separate;border-spacing:0;margin-top:8px}
    th{ text-align:left;padding:8px;border-bottom:2px solid var(--line);font-size:12px;color:#444}
    td{ padding:8px;border-bottom:1px solid var(--line);font-size:13px;vertical-align:top}
    @media (max-width:1100px){.cols-4{grid-template-columns:1fr 1fr}}
    @media (max-width:700px){.cols-4{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header>
    <div class="wrap brand">
      <div class="logo">B2P</div>
      <div>
        <h1>Board2Plan – 5-Day Plan</h1>
        <div class="sub">Business Type + Goal + Tone → Generate → Export CSV/Excel</div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="panel">
      <div class="grid cols-4">
        <div>
          <label for="bizType">Business Type</label>
          <select id="bizType">
            <option>Restaurant</option>
            <option>Home Services / Trades</option>
            <option>Real Estate</option>
            <option>Beauty / Salon</option>
            <option>E-commerce Retail</option>
            <option>Professional Services</option>
            <option>Nonprofit / Community</option>
            <option>Travel & Hospitality</option>
            <option>Healthcare / Wellness</option>
            <option>Education / Coaching</option>
            <option>Fitness</option>
            <option>Automotive</option>
            <option>Events / Venues</option>
            <option>Tech / SaaS</option>
            <option>Legal Services</option>
            <option>Financial Services</option>
          </select>
        </div>
        <div>
          <label for="goal">Goal</label>
          <select id="goal">
            <option>Lead Generation</option>
            <option>Engagement</option>
            <option>Awareness</option>
            <option>Sales</option>
          </select>
        </div>
        <div>
          <label for="tone">Content Tone</label>
          <select id="tone">
            <option>Educational</option>
            <option>Promotional</option>
            <option>Community</option>
            <option>Behind the Scenes</option>
            <option>Trend-Driven</option>
          </select>
        </div>
        <div>
          <label for="startDate">Start Date (Day 1)</label>
          <input type="date" id="startDate" />
        </div>
      </div>
      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
        <button id="generate">Generate / Refresh Plan</button>
        <button id="exportCSV" class="ghost">Export CSV</button>
        <button id="downloadXLS" class="ghost">Download Workbook (.xls)</button>
        <button id="print" class="ghost">Print / Save PDF</button>
      </div>
    </section>

    <nav style="display:flex;gap:10px;margin-top:12px">
      <span class="pill">5-Day Plan</span>
    </nav>
    <table id="table5"></table>

    <section id="playbookSection" style="border:1px solid var(--line);border-radius:14px;padding:16px;background:#fff;margin-top:14px">
      <h3 style="margin:0 0 8px">Playbook (Auto-generated)</h3>
      <p class="muted" style="margin:0 0 12px"><span id="pbHeader"></span></p>
      <div id="playbookBox"></div>
    </section>
  </main>

  <script>
    // ---- ASCII-safe columns (no special hyphens) ----
    const columns = ["Day","Date","Platform","Content Type","Post Concept","Content Pillar","Call to Action","Primary Hashtags","Link / UTM","Asset","Status","Notes","Best Post Time"];

    // ---- Best post times (default + industry overrides) ----
    const BestTimesDefault = {"Instagram":"11:00 AM","Instagram Stories":"10:00 AM","Facebook":"12:00 PM","LinkedIn":"9:00 AM","TikTok":"7:30 PM","YouTube Shorts":"6:00 PM","Twitter/X":"1:00 PM","Pinterest":"8:00 PM"};
    const BestTimesByIndustry = {
      "Restaurant": {"Instagram":"1:00 PM","Instagram Stories":"11:30 AM","Facebook":"12:30 PM","TikTok":"8:00 PM","YouTube Shorts":"7:00 PM","Pinterest":"9:00 PM"},
      "Home Services / Trades": {"Facebook":"6:30 PM","LinkedIn":"8:30 AM","Instagram":"12:00 PM","TikTok":"8:30 PM","YouTube Shorts":"7:00 PM"},
      "Real Estate": {"Instagram":"12:30 PM","Facebook":"1:00 PM","LinkedIn":"8:30 AM","TikTok":"7:30 PM","YouTube Shorts":"6:30 PM"},
      "Beauty / Salon": {"Instagram":"1:30 PM","Instagram Stories":"10:30 AM","TikTok":"8:30 PM","YouTube Shorts":"7:30 PM","Pinterest":"9:30 PM"},
      "E-commerce Retail": {"Instagram":"12:00 PM","Facebook":"1:00 PM","TikTok":"9:00 PM","YouTube Shorts":"7:00 PM","Pinterest":"9:30 PM"},
      "Professional Services": {"LinkedIn":"8:00 AM","Twitter/X":"12:00 PM","Instagram":"1:00 PM","YouTube Shorts":"6:00 PM"},
      "Nonprofit / Community": {"Facebook":"12:30 PM","Instagram":"1:00 PM","Instagram Stories":"11:00 AM","TikTok":"8:00 PM"},
      "Travel & Hospitality": {"Instagram":"11:30 AM","Facebook":"12:00 PM","TikTok":"8:30 PM","YouTube Shorts":"7:00 PM","Pinterest":"8:30 PM"},
      "Healthcare / Wellness": {"Facebook":"12:00 PM","Instagram":"11:30 AM","LinkedIn":"9:00 AM","TikTok":"7:30 PM"},
      "Education / Coaching": {"LinkedIn":"8:30 AM","Instagram":"12:30 PM","YouTube Shorts":"6:30 PM","TikTok":"8:30 PM"},
      "Fitness": {"Instagram":"11:30 AM","TikTok":"8:30 PM","YouTube Shorts":"7:00 PM","Instagram Stories":"9:30 AM"},
      "Automotive": {"Facebook":"12:30 PM","Instagram":"1:00 PM","YouTube Shorts":"6:30 PM","TikTok":"8:00 PM"},
      "Events / Venues": {"Instagram":"12:30 PM","Facebook":"1:00 PM","TikTok":"8:30 PM","Instagram Stories":"10:30 AM"},
      "Tech / SaaS": {"LinkedIn":"8:30 AM","Twitter/X":"12:30 PM","YouTube Shorts":"6:00 PM"},
      "Legal Services": {"LinkedIn":"8:30 AM","Facebook":"12:30 PM","Instagram":"1:00 PM"},
      "Financial Services": {"LinkedIn":"8:30 AM","Twitter/X":"12:30 PM","Instagram":"12:30 PM","YouTube Shorts":"6:30 PM"}
    };

    function normalizeBiz(b){
      const k = String(b||'').toLowerCase().replace(/[^a-z]/g,'');
      const map = {
        restaurant:"Restaurant",
        homeservicestrades:"Home Services / Trades", homeservices:"Home Services / Trades", trades:"Home Services / Trades",
        realestate:"Real Estate",
        beauty:"Beauty / Salon", beautysalon:"Beauty / Salon", salon:"Beauty / Salon",
        ecommerce:"E-commerce Retail", ecommerceretail:"E-commerce Retail",
        professionalservices:"Professional Services",
        nonprofit:"Nonprofit / Community", community:"Nonprofit / Community",
        travelhospitality:"Travel & Hospitality", travel:"Travel & Hospitality", hospitality:"Travel & Hospitality",
        healthcarewellness:"Healthcare / Wellness", healthcare:"Healthcare / Wellness", wellness:"Healthcare / Wellness",
        educationcoaching:"Education / Coaching", education:"Education / Coaching", coaching:"Education / Coaching",
        fitness:"Fitness",
        automotive:"Automotive",
        eventsvenues:"Events / Venues", events:"Events / Venues", venues:"Events / Venues",
        techsaas:"Tech / SaaS", tech:"Tech / SaaS", saas:"Tech / SaaS",
        legalservices:"Legal Services", legal:"Legal Services",
        financialservices:"Financial Services", financial:"Financial Services"
      };
      return map[k] || b;
    }
    function getBestTimes(biz){ const norm=normalizeBiz(biz); return Object.assign({}, BestTimesDefault, BestTimesByIndustry[norm]||{}); }
    function bestPostTime(platform,biz){ const t=getBestTimes(biz); return t[platform]||"11:30 AM"; }

    const PlatformOrder = ["Instagram","Facebook","LinkedIn","TikTok","YouTube Shorts","Instagram Stories","Twitter/X","Pinterest"];

    // ---- Concise Idea Library (3–5 per industry) ----
    const IdeaLib = {
      "Restaurant":[
        {concept:"Chef special spotlight with ingredient origin",pillar:"Educational",hashtags:"#LocalEats #ChefSpecial #Foodie",cta:"Reserve a table",platforms:["Instagram","Facebook","TikTok"]},
        {concept:"Happy hour carousel with price callouts",pillar:"Promotional",hashtags:"#HappyHour #DrinksDeal #AfterWork",cta:"Book now",platforms:["Instagram","Facebook"]},
        {concept:"Behind-the-scenes prep time-lapse",pillar:"Behind the Scenes",hashtags:"#KitchenLife #MadeFresh #BTS",cta:"See today’s menu",platforms:["TikTok","Instagram"]},
        {concept:"Customer review quote graphic",pillar:"Community",hashtags:"#CustomerLove #ThankYou #5Stars",cta:"Leave a review",platforms:["Instagram","Facebook"]}
      ],
      "Home Services / Trades":[
        {concept:"Seasonal maintenance checklist (saveable)",pillar:"Education",hashtags:"#HomeFix #Maintenance #Checklist",cta:"Request a free quote",platforms:["Facebook","Instagram","LinkedIn"]},
        {concept:"Before/after repair carousel",pillar:"Before/After",hashtags:"#BeforeAfter #LocalPro #Renovation",cta:"Book inspection",platforms:["Instagram","Facebook"]},
        {concept:"Client testimonial with photo",pillar:"Testimonials",hashtags:"#5Stars #LocalBusiness #Trust",cta:"Call now",platforms:["Facebook","Instagram"]}
      ],
      "Real Estate":[
        {concept:"New listing carousel: highlights + neighborhood",pillar:"Promotional",hashtags:"#NewListing #OpenHouse #DreamHome",cta:"Book a showing",platforms:["Instagram","Facebook","LinkedIn"]},
        {concept:"Market update chart (median price)",pillar:"Educational",hashtags:"#MarketUpdate #RealEstateTips #LocalStats",cta:"Get your home value",platforms:["LinkedIn","Facebook"]},
        {concept:"Client success story with keys photo",pillar:"Community",hashtags:"#Sold #JustClosed #HappyHome",cta:"Start your search",platforms:["Instagram","Facebook"]}
      ],
      "Beauty / Salon":[
        {concept:"Transformation before/after Reel",pillar:"Transformations",hashtags:"#HairTransformation #GlowUp #Salon",cta:"Book now",platforms:["Instagram","TikTok"]},
        {concept:"Product tip quick-cut video",pillar:"Product tips",hashtags:"#SalonTips #ProStylist #HealthyHair",cta:"See open slots",platforms:["Instagram","YouTube Shorts"]},
        {concept:"Hygiene & tools BTS",pillar:"BTS & hygiene",hashtags:"#CleanSalon #ProTools #Trust",cta:"DM 'GLOW'",platforms:["Instagram Stories","Instagram"]}
      ],
      "E-commerce Retail":[
        {concept:"UGC unboxing (stitches/duets allowed)",pillar:"UGC",hashtags:"#Unboxing #ShopNow #Bestsellers",cta:"Shop the drop",platforms:["TikTok","Instagram"]},
        {concept:"How-to mini tutorial",pillar:"How-to",hashtags:"#HowTo #ProductHack #DailyUse",cta:"Add to cart",platforms:["Instagram","YouTube Shorts"]},
        {concept:"Bundle & save promo",pillar:"Promotions",hashtags:"#BundleAndSave #Deal #Gift",cta:"Claim bundle",platforms:["Instagram","Facebook"]}
      ],
      "Professional Services":[
        {concept:"3-step framework carousel",pillar:"Frameworks",hashtags:"#Framework #B2B #Operations",cta:"Book a consult",platforms:["LinkedIn","Instagram"]},
        {concept:"Case study metric highlight",pillar:"Case studies",hashtags:"#CaseStudy #ROI #Outcome",cta:"See case study",platforms:["LinkedIn","Twitter/X"]},
        {concept:"Free audit promo with lead form",pillar:"Promotions",hashtags:"#Audit #FreeCheck #Consulting",cta:"DM 'AUDIT'",platforms:["LinkedIn","Instagram"]}
      ],
      "Nonprofit / Community":[
        {concept:"Impact story with beneficiary photo",pillar:"Impact stories",hashtags:"#GiveBack #Community #Impact",cta:"Donate today",platforms:["Facebook","Instagram"]},
        {concept:"Volunteer drive carousel",pillar:"Events",hashtags:"#Volunteer #DoGood #Local",cta:"Sign up to help",platforms:["Instagram","Facebook"]},
        {concept:"Thank-you wall (tag supporters)",pillar:"Gratitude",hashtags:"#ThankYou #CommunityLove #Support",cta:"Share this",platforms:["Instagram Stories","Facebook"]}
      ],
      "Travel & Hospitality":[
        {concept:"Destination tips (3 local spots)",pillar:"Destination tips",hashtags:"#TravelTips #Wanderlust #Hotel",cta:"Request a quote",platforms:["Instagram","TikTok"]},
        {concept:"Room/amenity walkthrough",pillar:"BTS tours",hashtags:"#HotelTour #Amenities #Vacation",cta:"See availability",platforms:["YouTube Shorts","Instagram"]},
        {concept:"Package promo + limited offer",pillar:"Packages",hashtags:"#TravelDeal #Getaway #Offer",cta:"DM dates",platforms:["Instagram","Facebook"]}
      ],
      "Healthcare / Wellness":[
        {concept:"Myth vs fact graphic",pillar:"Education",hashtags:"#HealthTips #Wellness #Prevention",cta:"Book a consultation",platforms:["Instagram","Facebook"]},
        {concept:"Short demo: correct technique (e.g., handwash)",pillar:"Seasonal",hashtags:"#SelfCare #Clinic #StayHealthy",cta:"Call clinic",platforms:["Instagram","YouTube Shorts"]},
        {concept:"Patient testimonial (consent)",pillar:"Testimonials",hashtags:"#PatientStory #Care #Trust",cta:"Send a question",platforms:["Instagram","Facebook"]}
      ],
      "Education / Coaching":[
        {concept:"Mini-lesson 3 slides",pillar:"Mini-lessons",hashtags:"#LearnToday #CoachTips #MicroLesson",cta:"Join waitlist",platforms:["LinkedIn","Instagram"]},
        {concept:"Student win spotlight",pillar:"Wins",hashtags:"#StudentWin #Outcome #Growth",cta:"Book discovery call",platforms:["Instagram","LinkedIn"]},
        {concept:"Behind the curriculum (why it works)",pillar:"Behind the curriculum",hashtags:"#Cohort #Curriculum #Clarity",cta:"Download worksheet",platforms:["Instagram","YouTube Shorts"]}
      ],
      "Fitness":[
        {concept:"Workout demo (form cues)",pillar:"WODs",hashtags:"#WOD #FitnessTips #Gym",cta:"Book a free trial",platforms:["Instagram","TikTok"]},
        {concept:"Nutrition swap (2 foods)",pillar:"Nutrition",hashtags:"#Nutrition #HealthySwap #FitJourney",cta:"Join the challenge",platforms:["Instagram","YouTube Shorts"]},
        {concept:"Member transformation story",pillar:"Transformations",hashtags:"#BeforeAfter #Progress #Coach",cta:"DM 'START'",platforms:["Instagram","Facebook"]}
      ],
      "Automotive":[
        {concept:"New arrival walk-around",pillar:"Inventory",hashtags:"#NewArrival #CarLife #Auto",cta:"Book a test drive",platforms:["Facebook","Instagram"]},
        {concept:"Service tip: warning lights",pillar:"Service tips",hashtags:"#CarCare #ServiceTips #Safety",cta:"Schedule service",platforms:["Instagram","YouTube Shorts"]},
        {concept:"Detailing secrets quick-cut",pillar:"Promos",hashtags:"#Detailing #Shine #AutoCare",cta:"Check eligibility",platforms:["Instagram","TikTok"]}
      ],
      "Events / Venues":[
        {concept:"Weekend lineup poster + CTA",pillar:"Lineups",hashtags:"#EventLineup #SaveTheDate #Live",cta:"Buy tickets",platforms:["Instagram","Facebook"]},
        {concept:"Vendor/artist spotlight",pillar:"Vendors/Artists",hashtags:"#VendorSpotlight #LocalEvents #Community",cta:"View schedule",platforms:["Instagram Stories","Instagram"]},
        {concept:"Recap mashup (UGC tags)",pillar:"Recaps & promos",hashtags:"#LastNight #Highlights #Memories",cta:"RSVP",platforms:["TikTok","Instagram"]}
      ],
      "Tech / SaaS":[
        {concept:"Feature spotlight (pain → feature → outcome)",pillar:"Features",hashtags:"#SaaS #FeatureSpotlight #Automation",cta:"Start free trial",platforms:["LinkedIn","Twitter/X"]},
        {concept:"Use-case carousel (role-based)",pillar:"Use cases",hashtags:"#UseCases #Ops #Dev",cta:"See case study",platforms:["LinkedIn","Instagram"]},
        {concept:"Roadmap sneak peek",pillar:"Roadmap",hashtags:"#ProductUpdate #Roadmap #BuildInPublic",cta:"Join webinar",platforms:["Twitter/X","YouTube Shorts"]}
      ],
      "Legal Services":[
        {concept:"Before you sign: checklist",pillar:"Tips",hashtags:"#LegalTips #KnowYourRights #LawFirm",cta:"Book a consult",platforms:["LinkedIn","Facebook"]},
        {concept:"3 mistakes to avoid",pillar:"Education",hashtags:"#Contract #SmallBiz #Risk",cta:"Ask a question",platforms:["LinkedIn","Instagram"]},
        {concept:"Client review quote",pillar:"Testimonials",hashtags:"#ClientLove #Trust #Counsel",cta:"Download checklist",platforms:["Facebook","Instagram"]}
      ],
      "Financial Services":[
        {concept:"Myth vs fact (savings/investing)",pillar:"Money tips",hashtags:"#MoneyTips #Finance101 #Wealth",cta:"Book intro call",platforms:["LinkedIn","Instagram"]},
        {concept:"Client win metric card",pillar:"Client wins",hashtags:"#Win #Planning #Goal",cta:"DM 'PLAN'",platforms:["LinkedIn","Twitter/X"]},
        {concept:"Behind the plan: how we work",pillar:"Planning BTS",hashtags:"#FinancialPlan #Advisor #Clarity",cta:"Download checklist",platforms:["Instagram","LinkedIn"]}
      ]
    };

    // ---- Compact Playbook library ----
    const PlaybookLib = {
      "Restaurant":{personas:["Busy local foodie","Date-night planner"],pillars:["Menu education","Promotions","Community & UGC","Behind the scenes"],angles:["Fresh, local ingredients","Limited-time specials","Weeknight convenience"],cadence:{"5day":"5 posts (3 IG/FB, 1 TikTok, 1 Stories)","30day":"24–28 posts + 6 Stories"},kpis:["ER 3–6% IG","+15% reservations clicks","5–10 new reviews/mo"],hashtags:["#LocalEats","#ChefSpecial","#Foodie","#DateNight","#SupportLocal"],caption:"Hook → Dish/offer detail → Social proof → CTA (Reserve/Order).",hooks:["Tonight’s special in 7s:","What our chef does differently:","Date night solved:"],ctas:["Reserve a table","Order online","Call now"],visual:["Warm lighting, macro shots, plating close-ups"]},
      "Home Services / Trades":{personas:["Homeowner in a hurry","Planner researching pros"],pillars:["Education","Before/After","Testimonials","Promotions"],angles:["Safety & reliability","Same-day service","Seasonal maintenance"],cadence:{"5day":"4 posts + 1 Story","30day":"20–24 posts + 8 Stories"},kpis:["+20% quote requests","ER 2–4%","Save rate >5% on checklists"],hashtags:["#HomeFix","#BeforeAfter","#LocalPro","#SafetyFirst","#Maintenance"],caption:"Problem → Quick tip → Proof → CTA (Free quote).",hooks:["Stop this mistake:","Quick fix for:","What to do first if:"],ctas:["Request a free quote","Save our number","Book inspection"],visual:["Before/after split, labelled steps, crew on-site"]},
      "Real Estate":{personas:["First-time buyer","Move-up seller"],pillars:["Listings","Market education","Client wins","Neighborhood life"],angles:["Clarity in a noisy market","Local expertise","Speed to close"],cadence:{"5day":"3 IG/FB + 1 LinkedIn + 1 Stories","30day":"22–26 posts across IG/FB/LI + Lives"},kpis:["+10% showings","ER 2–4%","Open house RSVPs +20%"],hashtags:["#NewListing","#OpenHouse","#MarketUpdate","#DreamHome","#JustSold"],caption:"Hook (address/price) → 3 highlights → Area benefit → CTA (Book a tour).",hooks:["This block just got a gem:","3 reasons this layout wins:","Price drop alert:"],ctas:["Book a showing","Get your valuation","DM 'LIST'"],visual:["Bright natural light, floor-plan overlay, neighborhood b-roll"]},
      "Beauty / Salon":{personas:["Transformation seeker","Maintenance client"],pillars:["Transformations","Product tips","UGC","BTS & hygiene"],angles:["Healthy hair/skin first","Pro formulas","Seasonal looks"],cadence:{"5day":"3 Reels + 2 Posts","30day":"20–24 posts + 8 Stories"},kpis:["Saves >6%","ER 4–7%","Bookings +15%"],hashtags:["#HairTransformation","#GlowUp","#SalonTips","#SkinCare","#ProStylist"],caption:"Before → Process snippet → After → Formula hint → CTA (Book).",hooks:["From brassy to glossy:","Formula breakdown:","How to keep this shine:"],ctas:["Book now","See open slots","DM 'GLOW'"],visual:["Consistent backdrop, crisp close-ups"]},
      "E-commerce Retail":{personas:["Gift buyer","Everyday user"],pillars:["Bestsellers","UGC","How-to","Drops & bundles"],angles:["Value + quality","Unboxing delight","Problem → solution"],cadence:{"5day":"3 IG/FB + 1 TikTok + 1 Shorts","30day":"24–28 posts + 8 Stories"},kpis:["CTR to PDP +20%","ER 2–4%","UGC shares +10%"],hashtags:["#Bestsellers","#Unboxing","#ShopNow","#UGC","#BundleAndSave"],caption:"Hook → Benefit bullets → Social proof → CTA (Shop link).",hooks:["Wait till you see the 3rd item:","Unbox with me:","Solve this daily hassle:"],ctas:["Shop the drop","Add to cart","Claim bundle"],visual:["Fast cuts, hands-in-frame, packaging ASMR"]},
      "Professional Services":{personas:["Decision-maker","Researcher"],pillars:["Frameworks","Case studies","Testimonials","Promos (audits)"],angles:["Measurable outcomes","Process clarity","Trusted experts"],cadence:{"5day":"3 LI + 1 X + 1 IG","30day":"20–24 posts across LI/X/IG"},kpis:["Consult calls +20%","ER 1.5–3% LI","Whitepaper downloads +15%"],hashtags:["#CaseStudy","#Framework","#B2B","#Consulting","#ROI"],caption:"Problem → Approach → Result metric → CTA (Book consult).",hooks:["We cut cost by 27% using:","3-step play to fix:","Stop doing this in Q4:"],ctas:["Book a consult","Download checklist","DM 'AUDIT'"],visual:["Charts with callouts, clean carousels"]},
      "Nonprofit / Community":{personas:["Local supporter","Volunteer"],pillars:["Impact stories","Events","Education","Gratitude"],angles:["Transparency","Community first","Every gift counts"],cadence:{"5day":"4 posts + 1 Story","30day":"20–24 posts + 8 Stories"},kpis:["Donations +15%","Volunteer signups +20%","ER 3–5%"],hashtags:["#GiveBack","#Community","#Volunteer","#Impact","#Nonprofit"],caption:"Person/impact → Where funds go → Next step → CTA (Donate/Volunteer).",hooks:["Because of you, Maya…","This $10 becomes:","Help us reach 100 kits:"],ctas:["Donate today","Sign up to help","Share this"],visual:["Faces + quotes, warm tones, event prep BTS"]},
      "Travel & Hospitality":{personas:["Weekend tripper","Family planner"],pillars:["Destination tips","Packages","Reviews","BTS tours"],angles:["Stress-free planning","Local secrets","Limited offers"],cadence:{"5day":"3 IG/TikTok + 1 FB + 1 Stories","30day":"24–28 posts + 10 Stories + 2 Lives"},kpis:["Inquiries +20%","ER 3–6%","Saves >6% on guides"],hashtags:["#TravelTips","#Wanderlust","#Hotel","#Vacation","#TravelDeal"],caption:"Hook (season) → 3 tips → Package value → CTA (Request quote).",hooks:["3 local spots only locals know:","Pack smarter for:","Best month to go:"],ctas:["Request a quote","See availability","DM dates"],visual:["Golden hour b-roll, room walk-throughs, quick maps"]},
      "Healthcare / Wellness":{personas:["Preventive care","Condition-specific"],pillars:["Education","Myth vs fact","Testimonials","Seasonal"],angles:["Trust & safety","Evidence-based","Accessible care"],cadence:{"5day":"4 posts + 1 Story","30day":"20–24 posts + Stories"},kpis:["Bookings +15%","ER 2–4%","DM inquiries +20%"],hashtags:["#Wellness","#Prevention","#HealthTips","#SelfCare","#Clinic"],caption:"Symptom/concern → Plain-English tip → When to see a pro → CTA.",hooks:["Myth vs fact:","3 signs you should check:","Save this for flu season:"],ctas:["Book a consultation","Call clinic","Send a question"],visual:["Clean infographics, friendly staff photos"]},
      "Education / Coaching":{personas:["Self-improver","Career switcher"],pillars:["Mini-lessons","Wins","Behind the curriculum","CTA to cohort"],angles:["Clarity + accountability","Small daily wins","Community"],cadence:{"5day":"3 LI/IG + 1 Stories + 1 Live","30day":"22–26 posts + 4 Lives"},kpis:["Leads +20%","ER 2–5%","Waitlist growth"],hashtags:["#LearnToday","#CoachTips","#MicroLesson","#Cohort","#Grow"],caption:"Hook (problem) → 3-step mini lesson → Download/DM → CTA.",hooks:["If you struggle with:","A 5-minute way to:","Try this framework:"],ctas:["Book discovery call","Join waitlist","Download worksheet"],visual:["Slide carousels, whiteboard snippets"]},
      "Fitness":{personas:["Beginner","Challenge seeker"],pillars:["WODs","Nutrition","Transformations","Community"],angles:["Form first","Small habits","Coach support"],cadence:{"5day":"3 Reels/TikTok + 1 FB + 1 Stories","30day":"24–28 posts + 8 Stories"},kpis:["Trials +20%","ER 4–7%","Saves >7%"],hashtags:["#WOD","#FitnessTips","#Gym","#Nutrition","#FitJourney"],caption:"Hook → Demo → Coaching cue → CTA (Book free trial).",hooks:["Steal this workout:","Fix your form in 10s:","2 foods to swap:"],ctas:["Book a free trial","Join the challenge","DM 'START'"],visual:["Clear demos, timers, upbeat pacing"]},
      "Automotive":{personas:["New buyer","Service customer"],pillars:["Inventory","Service tips","Testimonials","Promos"],angles:["Trust & safety","Financing options","Ownership pride"],cadence:{"5day":"3 FB/IG + 1 Shorts + 1 Stories","30day":"22–26 posts + 6 Stories"},kpis:["Test-drive bookings +15%","Service bookings +10%","ER 2–4%"],hashtags:["#CarCare","#NewArrival","#AutoLife","#ServiceTips","#Detailing"],caption:"Hook (feature) → Benefit → Offer/financing → CTA.",hooks:["Why this trim is worth it:","Don’t ignore this light:","Detailing secrets:"],ctas:["Book a test drive","Schedule service","Check eligibility"],visual:["Exterior roll, interior feature close-ups"]},
      "Events / Venues":{personas:["Local night out","Community group"],pillars:["Lineups","Vendors/Artists","BTS","Recaps & promos"],angles:["Make memories","Support local","Early bird value"],cadence:{"5day":"4 posts + 1 Stories","30day":"22–26 posts + 8 Stories + 2 Lives"},kpis:["Ticket sales +20%","ER 3–6%","Stories taps forward <40%"],hashtags:["#EventLineup","#SaveTheDate","#LocalEvents","#LiveMusic","#VendorSpotlight"],caption:"Hook (date/artist) → 3 reasons to go → Offer → CTA (Buy tickets).",hooks:["Weekend plans?","Sneak peek of the stage:","Last call for:"],ctas:["Buy tickets","View schedule","RSVP"],visual:["Stage lights, crowd moments, setup BTS"]},
      "Tech / SaaS":{personas:["Ops owner","IC user"],pillars:["Features","Use cases","Wins","Roadmap"],angles:["Time saved","Fewer errors","Integrations"],cadence:{"5day":"3 LI/X + 1 IG + 1 Shorts","30day":"22–26 posts + 4 Lives/Webinars"},kpis:["Trials +20%","ER 1.5–3%","Demo requests +15%"],hashtags:["#SaaS","#FeatureSpotlight","#UseCases","#Automation","#ProductUpdate"],caption:"Pain → Feature → Outcome metric → CTA (Start trial).",hooks:["Ship 2x faster with:","We killed 3 spreadsheets using:","Stop copy-pasting:"],ctas:["Start free trial","See case study","Join webinar"],visual:["Screen recordings, crisp UI zooms"]},
      "Legal Services":{personas:["Concerned individual","Small business owner"],pillars:["Tips","Testimonials","BTS prep","Webinars"],angles:["Plain-English","Responsive","First consult free"],cadence:{"5day":"4 posts + 1 Live/Q&A","30day":"20–24 posts + 4 Lives"},kpis:["Consults +15%","ER 2–4%","DMs +20%"],hashtags:["#LegalTips","#KnowYourRights","#LawFirm","#FreeConsult","#PlainEnglish"],caption:"Hook (common issue) → Tip → Risk avoided → CTA (Book consult).",hooks:["Before you sign:","Top 3 mistakes in:","Do this within 24h:"],ctas:["Book a consult","Ask a question","Download checklist"],visual:["Neutral palette, clear text cards, attorney portrait"]},
      "Financial Services":{personas:["Starter saver","Wealth builder"],pillars:["Money tips","Client wins","Planning BTS","Promos"],angles:["Clarity","Discipline","Long-term"],cadence:{"5day":"3 LI/IG + 1 X + 1 Stories","30day":"22–26 posts + 4 Lives"},kpis:["Intro calls +15%","ER 2–4%","Checklist downloads +20%"],hashtags:["#MoneyTips","#Finance101","#Wealth","#Investing","#FinancialPlan"],caption:"Myth → Fact → Simple step → CTA (Book intro).",hooks:["Stop doing this with your savings:","2 rules for beginners:","What to do in a dip:"],ctas:["Book intro call","Download checklist","DM 'PLAN'"],visual:["Clean charts, advisor desk shots"]}
    };

    function buildPlaybook(biz,tone,goal){
      const p = PlaybookLib[biz] || PlaybookLib["Professional Services"];
      const html = `
        <div class="grid" style="grid-template-columns:repeat(2,minmax(0,1fr));gap:14px">
          <div>
            <strong>Business:</strong> ${biz} &nbsp; • &nbsp; <strong>Goal:</strong> ${goal} &nbsp; • &nbsp; <strong>Tone:</strong> ${tone}
            <h4 style="margin:10px 0 6px">Audience Personas</h4>
            <ul style="margin:0 0 10px;padding-left:18px">${p.personas.map(x=>`<li>${x}</li>`).join('')}</ul>
            <h4 style="margin:0 0 6px">Content Pillars</h4>
            <ul style="margin:0 0 10px;padding-left:18px">${p.pillars.map(x=>`<li>${x}</li>`).join('')}</ul>
            <h4 style="margin:0 0 6px">Messaging Angles</h4>
            <ul style="margin:0 0 10px;padding-left:18px">${p.angles.map(x=>`<li>${x}</li>`).join('')}</ul>
            <h4 style="margin:0 0 6px">Posting Cadence</h4>
            <p class="muted">5-Day: ${p.cadence["5day"]} • 30-Day: ${p.cadence["30day"]}</p>
          </div>
          <div>
            <h4 style="margin:0 0 6px">Caption Framework</h4>
            <p>${p.caption} <em>(tone: ${tone})</em></p>
            <h4 style="margin:8px 0 6px">Hook Starters</h4>
            <ul style="margin:0 0 10px;padding-left:18px">${p.hooks.map(x=>`<li>${x}</li>`).join('')}</ul>
            <h4 style="margin:0 0 6px">CTA Examples</h4>
            <p>${p.ctas.join(' • ')}</p>
            <h4 style="margin:0 0 6px">Default Hashtags</h4>
            <p>${p.hashtags.join(' ')}</p>
            <h4 style="margin:0 0 6px">Visual Guidance</h4>
            <p class="muted">${p.visual.join(', ')}</p>
            <h4 style="margin:8px 0 6px">KPI Targets</h4>
            <p class="muted">${p.kpis.join(' • ')}</p>
          </div>
        </div>`;
      return html;
    }

    function formatDate(base,add){const d=new Date(base);d.setDate(d.getDate()+add);return d.toLocaleDateString(undefined,{year:'numeric',month:'short',day:'2-digit'})}
    function pickPlatform(idea,i){return Array.isArray(idea.platforms)&&idea.platforms.length?idea.platforms[i%idea.platforms.length]:PlatformOrder[i%PlatformOrder.length]}

    function planRow(i,date,idea,platform,biz){
      const map={"Instagram":"Image / Reel","Instagram Stories":"Stories (3-5 slides)","Facebook":"Image / Carousel","LinkedIn":"Carousel / Text Post","TikTok":"Short-form Video","YouTube Shorts":"Short-form Video","Twitter/X":"Text + Image","Pinterest":"Idea Pin"};
      return {"Day":`Day ${i+1}`,"Date":date,"Platform":platform,"Content Type":map[platform]||"Post","Post Concept":idea.concept,"Content Pillar":idea.pillar,"Call to Action":idea.cta,"Primary Hashtags":idea.hashtags,"Link / UTM":"https://example.com?utm_source="+encodeURIComponent(platform.toLowerCase())+"&utm_medium=social&utm_campaign=board2plan","Asset":"TBD","Status":"Planned","Notes":"","Best Post Time":bestPostTime(platform,biz)};
    }

    function buildPlan(total){
      const biz=document.getElementById('bizType').value;
      const startInput=document.getElementById('startDate').value;
      const start=startInput?new Date(startInput):new Date();
      const ideas=IdeaLib[biz] || IdeaLib["Professional Services"];
      const rows=[];
      for(let i=0;i<total;i++){
        const idea=ideas[i%ideas.length];
        const platform=pickPlatform(idea,i);
        const date=formatDate(start,i);
        rows.push(planRow(i,date,idea,platform,biz));
      }
      return rows;
    }

    function renderTable(id,rows){
      const table=document.getElementById(id);
      const thead=`<thead><tr>${columns.map(c=>`<th>${c}</th>`).join('')}</tr></thead>`;
      const body=rows.map(r=>`<tr>${columns.map(c=>`<td>${(r[c]??'')}</td>`).join('')}</tr>`).join('');
      table.innerHTML=thead+`<tbody>${body}</tbody>`;
    }

    function toCSV(rows){
      const header=columns.join(',');
      const esc=v=>'"'+String(v).replaceAll('"','""')+'"';
      const body=rows.map(r=>columns.map(c=>esc(r[c]??'')).join(',')).join('\n');
      return header+'\n'+body;
    }

    // Excel 2003 XML Workbook builder (multi-sheet) with exact legacy sheet names
    function excelCell(v){const s=String(v==null?\"\":v).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');return `<Cell><Data ss:Type=\"String\">${s}</Data></Cell>`;}
    function excelRow(arr){ return `<Row>${arr.map(excelCell).join('')}</Row>`; }
    function buildWorkbookXML(planRows,biz,tone,goal){
      const headerRow = excelRow(columns);
      const planXml = headerRow + planRows.map(r=>excelRow(columns.map(c=>r[c]??''))).join('');

      // Keywords & Hashtags
      const ideas = IdeaLib[biz] || [];
      const kwRows = [excelRow(['Concept','Pillar','Hashtags'])].concat(ideas.map(it=>excelRow([it.concept,it.pillar,it.hashtags])));
      const kwXml = kwRows.join('');

      // Analytics
      const analyticsCols = ['Date','Platform','Post URL','Impressions','Reach','Engagements','Saves','Clicks','Notes'];
      const analyticsXml = excelRow(analyticsCols);

      // Best Post Times
      const bptCols = ['Platform','Best Post Time'];
      const times = getBestTimes(biz);
      const bptXml = [excelRow(bptCols)].concat(Object.keys(times).map(p=>excelRow([p,times[p]]))).join('');

      // Accounts
      const acctCols = ['Platform','Handle','URL','Notes'];
      const acctXml = excelRow(acctCols);

      // Playbook flattened
      const p = PlaybookLib[biz] || PlaybookLib["Professional Services"];
      const pb = [
        excelRow([`Playbook for: ${biz} | Goal: ${goal} | Tone: ${tone}`]), excelRow(['']),
        excelRow(['Audience Personas']), ...p.personas.map(x=>excelRow([x])),
        excelRow(['']), excelRow(['Content Pillars']), ...p.pillars.map(x=>excelRow([x])),
        excelRow(['']), excelRow(['Messaging Angles']), ...p.angles.map(x=>excelRow([x])),
        excelRow(['']), excelRow(['Caption Framework']), excelRow([p.caption]),
        excelRow(['']), excelRow(['Hook Starters']), ...p.hooks.map(x=>excelRow([x])),
        excelRow(['']), excelRow(['CTA Examples']), excelRow([p.ctas.join(' • ')]),
        excelRow(['']), excelRow(['Default Hashtags']), excelRow([p.hashtags.join(' ')]),
        excelRow(['']), excelRow(['Visual Guidance']), excelRow([p.visual.join(', ')]),
        excelRow(['']), excelRow(['KPI Targets']), excelRow([p.kpis.join(' • ')]),
      ].join('');

      const xml = `<?xml version="1.0"?>
<?mso-application progid="Excel.Sheet"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
 xmlns:o="urn:schemas-microsoft-com:office:office"
 xmlns:x="urn:schemas-microsoft-com:office:excel"
 xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">
  <Worksheet ss:Name="5-Day Plan"><Table>${planXml}</Table></Worksheet>
  <Worksheet ss:Name="Keywords & Hashtags"><Table>${kwXml}</Table></Worksheet>
  <Worksheet ss:Name="Analytics"><Table>${analyticsXml}</Table></Worksheet>
  <Worksheet ss:Name="Best Post Times"><Table>${bptXml}</Table></Worksheet>
  <Worksheet ss:Name="Accounts"><Table>${acctXml}</Table></Worksheet>
  <Worksheet ss:Name="Playbook"><Table>${pb}</Table></Worksheet>
</Workbook>`;
      return xml;
    }

    function downloadXLS(filename, xml){
      const blob = new Blob([xml], {type: 'application/vnd.ms-excel'});
      const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download=filename; document.body.appendChild(a); a.click(); a.remove();
    }

    function refresh(){
      const biz=document.getElementById('bizType').value; 
      const tone=document.getElementById('tone').value;
      const goal=document.getElementById('goal').value;
      const rows = buildPlan(5);
      renderTable('table5', rows);
      document.getElementById('pbHeader').innerText = `Business: ${biz} • Goal: ${goal} • Tone: ${tone}`;
      document.getElementById('playbookBox').innerHTML = buildPlaybook(biz,tone,goal);

      document.getElementById('exportCSV').onclick=()=>{
        const csv=toCSV(rows);
        const a=document.createElement('a'); a.href=URL.createObjectURL(new Blob([csv],{type:'text/csv'})); a.download='Board2Plan_5Day.csv'; a.click();
      };
      document.getElementById('downloadXLS').onclick=()=>downloadXLS('Board2Plan_5Day.xls', buildWorkbookXML(rows,biz,tone,goal));
    }

    document.getElementById('generate').addEventListener('click', refresh);
    document.getElementById('print').addEventListener('click',()=>window.print());
    // initial render
    refresh();
  </script>
</body>
</html>
