<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Board2Plan – 5‑Day Plan (Goals Fix)</title>
  <style>
    :root{--teal:#008080;--ink:#111;--line:#e6eaee;--soft:#f6f8f9}
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial;color:var(--ink)}
    header{background:#fff;border-bottom:1px solid var(--line)}
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--teal),#18b4b4);display:grid;place-items:center;color:#fff;font-weight:800}
    h1{font-size:22px;margin:0}
    .sub{font-size:12px;color:#666}
    .panel{border:1px solid var(--line);border-radius:14px;padding:14px;background:var(--soft)}
    .grid{display:grid;gap:12px}
    .cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}
    button{padding:10px 12px;border:1px solid var(--line);border-radius:999px;cursor:pointer;background:#3b82f6;color:#fff;font-weight:600}
    .ghost{background:#fff;color:#222}
    .pill{display:inline-block;padding:4px 10px;border:1px solid var(--line);border-radius:999px;font-size:11px;color:#555}
    .muted{color:#666;font-size:12px}
    table{width:100%;border-collapse:separate;border-spacing:0;margin-top:8px}
    th{ text-align:left;padding:8px;border-bottom:2px solid var(--line);font-size:12px;color:#444}
    td{ padding:8px;border-bottom:1px solid var(--line);font-size:13px;vertical-align:top}
    @media (max-width:1100px){.cols-4{grid-template-columns:1fr 1fr}}
    @media (max-width:700px){.cols-4{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header>
    <div class="wrap brand">
      <div class="logo">B2P</div>
      <div>
        <h1>Board2Plan – 5‑Day Plan</h1>
        <div class="sub">Business Type + Goal + Tone → Generate → Export CSV/Excel</div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="panel">
      <div class="grid cols-4">
        <div>
          <label for="bizType">Business Type</label>
          <select id="bizType">
            <option>Restaurant</option>
            <option>Home Services / Trades</option>
            <option>Real Estate</option>
            <option>Beauty / Salon</option>
            <option>E‑commerce Retail</option>
            <option>Professional Services</option>
            <option>Nonprofit / Community</option>
            <option>Travel & Hospitality</option>
            <option>Healthcare / Wellness</option>
            <option>Education / Coaching</option>
            <option>Fitness</option>
            <option>Automotive</option>
            <option>Events / Venues</option>
            <option>Tech / SaaS</option>
            <option>Legal Services</option>
            <option>Financial Services</option>
          </select>
        </div>
        <div>
          <label for="goal">Goal</label>
          <select id="goal">
            <option>Lead Generation</option>
            <option>Engagement</option>
            <option>Awareness</option>
            <option>Sales</option>
          </select>
        </div>
        <div>
          <label for="tone">Content Tone</label>
          <select id="tone">
            <option>Educational</option>
            <option>Promotional</option>
            <option>Community</option>
            <option>Behind the Scenes</option>
            <option>Trend‑Driven</option>
          </select>
        </div>
        <div>
          <label for="startDate">Start Date (Day 1)</label>
          <input type="date" id="startDate" />
        </div>
      </div>
      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
        <button id="generate">Generate / Refresh Plan</button>
        <button id="exportCSV" class="ghost">Export CSV</button>
        <button id="downloadXLS" class="ghost">Download Workbook (.xls)</button>
        <button id="print" class="ghost">Print / Save PDF</button>
      </div>
    </section>

    <nav style="display:flex;gap:10px;margin-top:12px">
      <span class="pill">5‑Day Plan</span>
    </nav>
    <table id="table5"></table>

    <section id="playbookSection" style="border:1px solid var(--line);border-radius:14px;padding:16px;background:#fff;margin-top:14px">
      <h3 style="margin:0 0 8px">Playbook (Auto‑generated)</h3>
      <p class="muted" style="margin:0 0 12px"><span id="pbHeader"></span></p>
      <div id="playbookBox"></div>
    </section>
  </main>

  <script>
    const columns = ["Day","Date","Platform","Content Type","Post Concept","Content Pillar","Call‑to‑Action","Primary Hashtags","Link / UTM","Asset","Status","Notes","Best Post Time"];

    const BestTimesDefault = {"Instagram":"11:00 AM","Instagram Stories":"10:00 AM","Facebook":"12:00 PM","LinkedIn":"9:00 AM","TikTok":"7:30 PM","YouTube Shorts":"6:00 PM","Twitter/X":"1:00 PM","Pinterest":"8:00 PM"};
    const BestTimesByIndustry = {
      "Restaurant": {"Instagram":"1:00 PM","Instagram Stories":"11:30 AM","Facebook":"12:30 PM","TikTok":"8:00 PM","YouTube Shorts":"7:00 PM","Pinterest":"9:00 PM"},
      "Real Estate": {"Instagram":"12:30 PM","Facebook":"1:00 PM","LinkedIn":"8:30 AM","TikTok":"7:30 PM","YouTube Shorts":"6:30 PM"},
      "Professional Services": {"LinkedIn":"8:00 AM","Twitter/X":"12:00 PM","Instagram":"1:00 PM","YouTube Shorts":"6:00 PM"}
    };

    function normalizeBiz(b){
      const k = String(b||'').toLowerCase().replace(/[^a-z]/g,'');
      const map = {restaurant:"Restaurant", realestate:"Real Estate", professionalservices:"Professional Services"};
      return map[k] || b;
    }
    function getBestTimes(biz){ const norm=normalizeBiz(biz); return Object.assign({}, BestTimesDefault, BestTimesByIndustry[norm]||{}); }
    function bestPostTime(platform,biz){ const t=getBestTimes(biz); return t[platform]||"11:30 AM"; }

    const PlatformOrder = ["Instagram","Facebook","LinkedIn","TikTok","YouTube Shorts","Instagram Stories","Twitter/X","Pinterest"];

    const IdeaLib = {
      "Restaurant":[
        {"concept":"Chef special spotlight with ingredient origin","pillar":"Educational","hashtags":"#LocalEats #ChefSpecial #Foodie","cta":"Reserve a table","platforms":["Instagram","Facebook","TikTok"]},
        {"concept":"Happy hour carousel with price callouts","pillar":"Promotional","hashtags":"#HappyHour #DrinksDeal #AfterWork","cta":"Book now","platforms":["Instagram","Facebook"]},
        {"concept":"Behind‑the‑scenes prep time‑lapse","pillar":"Behind the Scenes","hashtags":"#KitchenLife #MadeFresh #BTS","cta":"See today’s menu","platforms":["TikTok","Instagram"]},
        {"concept":"Customer review quote graphic","pillar":"Community","hashtags":"#CustomerLove #ThankYou #5Stars","cta":"Leave a review","platforms":["Instagram","Facebook"]},
        {"concept":"Limited menu drop with countdown","pillar":"Trend‑Driven","hashtags":"#LimitedTime #FoodLaunch #Countdown","cta":"Order online","platforms":["Instagram Stories","Facebook"]}
      ],
      "Real Estate":[
        {"concept":"New listing carousel: highlights + neighborhood","pillar":"Promotional","hashtags":"#NewListing #OpenHouse #DreamHome","cta":"Book a showing","platforms":["Instagram","Facebook","LinkedIn"]},
        {"concept":"Market update chart (median price)","pillar":"Educational","hashtags":"#MarketUpdate #RealEstateTips #LocalStats","cta":"Get your home value","platforms":["LinkedIn","Facebook"]},
        {"concept":"Client success story with keys photo","pillar":"Community","hashtags":"#Sold #JustClosed #HappyHome","cta":"Start your search","platforms":["Instagram","Facebook"]},
        {"concept":"Neighborhood guide (schools, parks, coffee)","pillar":"Educational","hashtags":"#NeighborhoodGuide #LocalLove #Relocation","cta":"Download the guide","platforms":["Instagram","LinkedIn"]}
      ],
      "Professional Services":[
        {"concept":"3‑step framework carousel","pillar":"Frameworks","hashtags":"#Framework #B2B #Operations","cta":"Book a consult","platforms":["LinkedIn","Instagram"]},
        {"concept":"Case study metric highlight","pillar":"Case studies","hashtags":"#CaseStudy #ROI #Outcome","cta":"See case study","platforms":["LinkedIn","Twitter/X"]},
        {"concept":"Free audit promo with lead form","pillar":"Promotions","hashtags":"#Audit #FreeCheck #Consulting","cta":"DM 'AUDIT'","platforms":["LinkedIn","Instagram"]}
      ]
    };

    const PlaybookLib = {
      "Restaurant":{personas:["Busy local foodie","Date‑night planner"],pillars:["Menu education","Promotions","Community & UGC","Behind the scenes"],angles:["Fresh, local ingredients","Limited‑time specials","Weeknight convenience"],cadence:{"5day":"5 posts (3 IG/FB, 1 TikTok, 1 Stories)","30day":"24–28 posts + 6 Stories"},kpis:["ER 3–6% IG","+15% reservations clicks","5–10 new reviews/mo"],hashtags:["#LocalEats","#ChefSpecial","#Foodie","#DateNight","#SupportLocal"],caption:"Hook ➜ Dish/offer detail ➜ Social proof ➜ CTA (Reserve/Order).",hooks:["Tonight’s special in 7s:","What our chef does differently:","Date night solved:"],ctas:["Reserve a table","Order online","Call now"],visual:["Warm lighting, macro shots, plating close‑ups"]},
      "Real Estate":{personas:["First‑time buyer","Move‑up seller"],pillars:["Listings","Market education","Client wins","Neighborhood life"],angles:["Clarity in a noisy market","Local expertise","Speed to close"],cadence:{"5day":"3 IG/FB + 1 LI + 1 Stories","30day":"22–26 posts + Lives"},kpis:["+10% showings","ER 2–4%","Open house RSVPs +20%"],hashtags:["#NewListing","#OpenHouse","#MarketUpdate","#DreamHome","#JustSold"],caption:"Hook (address/price) ➜ 3 highlights ➜ Area benefit ➜ CTA (Book a tour).",hooks:["This block just got a gem:","3 reasons this layout wins:","Price drop alert:"],ctas:["Book a showing","Get your valuation","DM 'LIST'"],visual:["Natural light, floor‑plan overlay, neighborhood b‑roll"]},
      "Professional Services":{personas:["Decision‑maker","Researcher"],pillars:["Frameworks","Case studies","Testimonials","Promos (audits)"],angles:["Measurable outcomes","Process clarity","Trusted experts"],cadence:{"5day":"3 LI + 1 X + 1 IG","30day":"20–24 posts across LI/X/IG"},kpis:["Consult calls +20%","ER 1.5–3% LI","Whitepaper downloads +15%"],hashtags:["#CaseStudy","#Framework","#B2B","#Consulting","#ROI"],caption:"Problem ➜ Approach ➜ Result ➜ CTA (Consult).",hooks:["We cut cost by 27% with:","3‑step play to fix:","Stop doing this in Q4:"],ctas:["Book a consult","Download checklist","DM 'AUDIT'"],visual:["Clean carousels, founder POV"]}
    };

    function buildPlaybook(biz,tone,goal){
      const p = PlaybookLib[biz] || PlaybookLib["Professional Services"];
      const html = `
        <div class="grid" style="grid-template-columns:repeat(2,minmax(0,1fr));gap:14px">
          <div>
            <strong>Business:</strong> ${biz} &nbsp; • &nbsp; <strong>Goal:</strong> ${goal} &nbsp; • &nbsp; <strong>Tone:</strong> ${tone}
            <h4 style="margin:10px 0 6px">Audience Personas</h4>
            <ul style="margin:0 0 10px;padding-left:18px">${p.personas.map(x=>`<li>${x}</li>`).join('')}</ul>
            <h4 style="margin:0 0 6px">Content Pillars</h4>
            <ul style="margin:0 0 10px;padding-left:18px">${p.pillars.map(x=>`<li>${x}</li>`).join('')}</ul>
            <h4 style="margin:0 0 6px">Messaging Angles</h4>
            <ul style="margin:0 0 10px;padding-left:18px">${p.angles.map(x=>`<li>${x}</li>`).join('')}</ul>
            <h4 style="margin:0 0 6px">Posting Cadence</h4>
            <p class="muted">5‑Day: ${p.cadence["5day"]} • 30‑Day: ${p.cadence["30day"]}</p>
          </div>
          <div>
            <h4 style="margin:0 0 6px">Caption Framework</h4>
            <p>${p.caption} <em>(tone: ${tone})</em></p>
            <h4 style="margin:8px 0 6px">Hook Starters</h4>
            <ul style="margin:0 0 10px;padding-left:18px">${p.hooks.map(x=>`<li>${x}</li>`).join('')}</ul>
            <h4 style="margin:0 0 6px">CTA Examples</h4>
            <p>${p.ctas.join(' • ')}</p>
            <h4 style="margin:0 0 6px">Default Hashtags</h4>
            <p>${p.hashtags.join(' ')}</p>
            <h4 style="margin:0 0 6px">Visual Guidance</h4>
            <p class="muted">${p.visual.join(', ')}</p>
            <h4 style="margin:8px 0 6px">KPI Targets</h4>
            <p class="muted">${p.kpis.join(' • ')}</p>
          </div>
        </div>`;
      return html;
    }

    function formatDate(base,add){const d=new Date(base);d.setDate(d.getDate()+add);return d.toLocaleDateString(undefined,{year:'numeric',month:'short',day:'2-digit'})}
    function pickPlatform(idea,i){return Array.isArray(idea.platforms)&&idea.platforms.length?idea.platforms[i%idea.platforms.length]:PlatformOrder[i%PlatformOrder.length]}

    function planRow(i,date,idea,platform,biz){
      const map={"Instagram":"Image / Reel","Instagram Stories":"Stories (3‑5 slides)","Facebook":"Image / Carousel","LinkedIn":"Carousel / Text Post","TikTok":"Short‑form Video","YouTube Shorts":"Short‑form Video","Twitter/X":"Text + Image","Pinterest":"Idea Pin"};
      return {"Day":`Day ${i+1}`,"Date":date,"Platform":platform,"Content Type":map[platform]||"Post","Post Concept":idea.concept,"Content Pillar":idea.pillar,"Call‑to‑Action":idea.cta,"Primary Hashtags":idea.hashtags,"Link / UTM":"https://example.com?utm_source="+encodeURIComponent(platform.toLowerCase())+"&utm_medium=social&utm_campaign=board2plan","Asset":"TBD","Status":"Planned","Notes":"","Best Post Time":bestPostTime(platform,biz)};
    }

    function buildPlan(total){
      const biz=document.getElementById('bizType').value;
      const startInput=document.getElementById('startDate').value;
      const start=startInput?new Date(startInput):new Date();
      const ideas=IdeaLib[biz] || IdeaLib["Professional Services"];
      const rows=[];
      for(let i=0;i<total;i++){
        const idea=ideas[i%ideas.length];
        const platform=pickPlatform(idea,i);
        const date=formatDate(start,i);
        rows.push(planRow(i,date,idea,platform,biz));
      }
      return rows;
    }

    function renderTable(id,rows){
      const table=document.getElementById(id);
      const thead=`<thead><tr>${columns.map(c=>`<th>${c}</th>`).join('')}</tr></thead>`;
      const body=rows.map(r=>`<tr>${columns.map(c=>`<td>${(r[c]??'')}</td>`).join('')}</tr>`).join('');
      table.innerHTML=thead+`<tbody>${body}</tbody>`;
    }

    function toCSV(rows){
      const header=columns.join(',');
      const esc=v=>'"'+String(v).replaceAll('"','""')+'"';
      const body=rows.map(r=>columns.map(c=>esc(r[c]??'')).join(',')).join('\n');
      return header+'\n'+body;
    }

    // Excel 2003 XML Workbook builder (multi‑sheet) with "5‑Day Plan" sheet name
    function excelCell(v){const s=String(v==null?\"\":v).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');return `<Cell><Data ss:Type=\"String\">${s}</Data></Cell>`;}
    function excelRow(arr){ return `<Row>${arr.map(excelCell).join('')}</Row>`; }
    function buildWorkbookXML(planRows,biz,tone,goal){
      const headerRow = excelRow(columns);
      const planXml = headerRow + planRows.map(r=>excelRow(columns.map(c=>r[c]??''))).join('');

      // Keywords & Hashtags
      const ideas = IdeaLib[biz] || [];
      const kwRows = [excelRow(['Concept','Pillar','Hashtags'])].concat(ideas.map(it=>excelRow([it.concept,it.pillar,it.hashtags])));
      const kwXml = kwRows.join('');

      // Analytics
      const analyticsCols = ['Date','Platform','Post URL','Impressions','Reach','Engagements','Saves','Clicks','Notes'];
      const analyticsXml = excelRow(analyticsCols);

      // Best Post Times
      const bptCols = ['Platform','Best Post Time'];
      const times = getBestTimes(biz);
      const bptXml = [excelRow(bptCols)].concat(Object.keys(times).map(p=>excelRow([p,times[p]]))).join('');

      // Accounts
      const acctCols = ['Platform','Handle','URL','Notes'];
      const acctXml = excelRow(acctCols);

      // Playbook (flattened)
      const p = PlaybookLib[biz] || PlaybookLib["Professional Services"];
      const pb = [
        excelRow([`Playbook for: ${biz} | Goal: ${goal} | Tone: ${tone}`]), excelRow(['']),
        excelRow(['Audience Personas']), ...p.personas.map(x=>excelRow([x])),
        excelRow(['']), excelRow(['Content Pillars']), ...p.pillars.map(x=>excelRow([x])),
        excelRow(['']), excelRow(['Messaging Angles']), ...p.angles.map(x=>excelRow([x])),
        excelRow(['']), excelRow(['Caption Framework']), excelRow([p.caption]),
        excelRow(['']), excelRow(['Hook Starters']), ...p.hooks.map(x=>excelRow([x])),
        excelRow(['']), excelRow(['CTA Examples']), excelRow([p.ctas.join(' • ')]),
        excelRow(['']), excelRow(['Default Hashtags']), excelRow([p.hashtags.join(' ')]),
        excelRow(['']), excelRow(['Visual Guidance']), excelRow([p.visual.join(', ')]),
        excelRow(['']), excelRow(['KPI Targets']), excelRow([p.kpis.join(' • ')]),
      ].join('');

      const xml = `<?xml version="1.0"?>
<?mso-application progid="Excel.Sheet"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
 xmlns:o="urn:schemas-microsoft-com:office:office"
 xmlns:x="urn:schemas-microsoft-com:office:excel"
 xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">
  <Worksheet ss:Name="5-Day Plan"><Table>${planXml}</Table></Worksheet>
  <Worksheet ss:Name="Keywords & Hashtags"><Table>${kwXml}</Table></Worksheet>
  <Worksheet ss:Name="Analytics"><Table>${analyticsXml}</Table></Worksheet>
  <Worksheet ss:Name="Best Post Times"><Table>${bptXml}</Table></Worksheet>
  <Worksheet ss:Name="Accounts"><Table>${acctXml}</Table></Worksheet>
  <Worksheet ss:Name="Playbook"><Table>${pb}</Table></Worksheet>
</Workbook>`;
      return xml;
    }

    function downloadXLS(filename, xml){
      const blob = new Blob([xml], {type: 'application/vnd.ms-excel'});
      const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download=filename; document.body.appendChild(a); a.click(); a.remove();
    }

    function refresh(){
      const biz=document.getElementById('bizType').value; 
      const tone=document.getElementById('tone').value;
      const goal=document.getElementById('goal').value;
      const rows = buildPlan(5);
      renderTable('table5', rows);
      document.getElementById('pbHeader').innerText = `Business: ${biz} • Goal: ${goal} • Tone: ${tone}`;
      document.getElementById('playbookBox').innerHTML = buildPlaybook(biz,tone,goal);

      document.getElementById('exportCSV').onclick=()=>{
        const csv=toCSV(rows);
        const a=document.createElement('a'); a.href=URL.createObjectURL(new Blob([csv],{type:'text/csv'})); a.download='Board2Plan_5Day.csv'; a.click();
      };
      document.getElementById('downloadXLS').onclick=()=>downloadXLS('Board2Plan_5Day.xls', buildWorkbookXML(rows,biz,tone,goal));
    }

    document.getElementById('generate').addEventListener('click', refresh);
    document.getElementById('print').addEventListener('click',()=>window.print());
    refresh();
  </script>
</body>
</html>
